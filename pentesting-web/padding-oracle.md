# Padding Oracle

Este tipo de ataque se aprovecha de una mala implementación del algoritmo de encriptación **CBC,** permitiendo a un atacante el desencriptar información sin conocer la clave con la que fue cifrada. Nos podemos dar cuenta que un aplicativo es vulnerable a este ataque, cuando por ejemplo, tenemos siempre la misma cookie de sesión, debido a esto podremos tratar de realizar



{% embed url="https://blog.cloudflare.com/padding-oracles-and-the-decline-of-cbc-mode-ciphersuites/" %}

## Cómo funciona CBC

### Cifrado

Lo primero que se hace es dividir el mensaje a encriptar en bloques (múltiplos de 8), entonces utilizando la operación **XOR** sobre el primer bloque junto con un **IV** aleatorio, se aplica la operación en el primer bloque para posteriormente encriptarlo junto con una **key**. La salida encriptada del primer bloque se lo utiliza para aplicar al segundo también con otra operación XOR, y así hasta llegar al bloque final.

<figure><img src="../.gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

### Descifrado

Para desencriptar se hace la operatoria opuesta a la encriptación, sobre el último bloque se usa la **key** que tiene el servidor para aplicar una operación **XOR** junto con el anterior bloque encriptado.

<figure><img src="../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

### Padding

Como la encriptación se da por bloques de tamaño fijo, generalmente en el último bloque del mensaje se va a tener que rellenar hasta completar el tamaño del mismo. A este relleno lo llamamos **padding.** Usando el estándar PKCS7, se completa con el número de casillas faltantes las que estén vacías, de la siguiente manera:

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

### Teoría del Padding Oracle

